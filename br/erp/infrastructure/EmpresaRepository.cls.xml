<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="br.erp.infrastructure.EmpresaRepository">
<Super>%Persistent,br.erp.domain.model.empresa.EmpresaRepository</Super>
<TimeCreated>64569,38742.219222</TimeCreated>

<Method name="procurar">
<FormalSpec>empresaId:br.erp.domain.model.empresa.EmpresaId</FormalSpec>
<ReturnType>br.erp.domain.model.empresa.Empresa</ReturnType>
<Implementation><![CDATA[
    if (..%ExistsId( empresaId )){
        quit ..%OpenId( empresaId )
    }
    $$$ThrowOnError( $$$ERROR(5001, "Empresa nÃ£o encontrada."))
]]></Implementation>
</Method>

<Method name="procurarTodos">
<ReturnType>%ListOfObjects</ReturnType>
<Implementation><![CDATA[
    
    
    #dim statement As %SQL.Statement
    #dim sql As %String = "SELECT ID FROM br_erp_infrastructure.Empresa"
    #dim lista As %ListOfObjects
    
    set lista = ##class(%ListOfObjects).%New()
    set statement = ##class(%SQL.Statement).%ExecDirect(,sql)
    while (statement.%Next()){
        do lista.Insert( ##class(br.erp.infrastructure.Empresa).%OpenId( statement.ID ))
    }
    quit lista
]]></Implementation>
</Method>

<Method name="registar">
<FormalSpec>empresa:br.erp.domain.model.empresa.Empresa</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
    if (..%ExistsId( empresa.id )){
        set empresaNova = ..%OpenId( empresa.id )
    } else {
        set empresaNova = ..%New()
    }
    
    set empresaNova.descricao = ""
    set empresaNova.cnpj = empresa.cnpj
    $$$ThrowOnError( empresaNova.%Save() )
]]></Implementation>
</Method>

<Property name="descricao">
<Type>%String</Type>
</Property>

<Property name="cnpj">
<Type>%String</Type>
</Property>

<Storage name="Default">
<Type>%Library.CacheStorage</Type>
<DataLocation>^br.erp.infC019.EmpresaRepo13CAD</DataLocation>
<DefaultData>EmpresaRepositoryDefaultData</DefaultData>
<IdLocation>^br.erp.infC019.EmpresaRepo13CAD</IdLocation>
<IndexLocation>^br.erp.infC019.EmpresaRepo13CAI</IndexLocation>
<StreamLocation>^br.erp.infC019.EmpresaRepo13CAS</StreamLocation>
<Data name="EmpresaRepositoryDefaultData">
<Structure>listnode</Structure>
<Subscript/>
<Value name="1">
<Value>%%CLASSNAME</Value>
</Value>
<Value name="2">
<Value>descricao</Value>
</Value>
<Value name="3">
<Value>cnpj</Value>
</Value>
</Data>
</Storage>
</Class>
</Export>
